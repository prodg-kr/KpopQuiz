<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>K-pop Quiz Game - ÎãπÏã†ÏùÄ K-pop ÎßàÏä§ÌÑ∞Ïù∏Í∞ÄÏöî? | K-pop„ÇØ„Ç§„Ç∫„Ç≤„Éº„É†</title>
    <meta name="description" content="BTS, BLACKPINK, NewJeans Îì± K-pop ÏïÑÌã∞Ïä§Ìä∏Ïóê ÎåÄÌïú ÏßÄÏãùÏùÑ ÌÖåÏä§Ìä∏Ìï¥Î≥¥ÏÑ∏Ïöî!">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé§</text></svg>">
    <style>
        :root {
            --bg: #0f1220;
            --card: #171a2b;
            --accent: #7c5cff;
            --accent-2: #ff5c9a;
            --text: #e9e9f1;
            --muted: #a9a9c7;
            --correct: #2ecc71;
            --wrong: #e74c3c;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            min-height: 100vh;
            display: grid;
            place-items: center;
            background: radial-gradient(1200px 600px at 20% 20%, #1b1f36 0%, var(--bg) 60%);
            color: var(--text);
            font-family: "Inter", "Noto Sans JP", "Noto Sans KR", system-ui, sans-serif;
            line-height: 1.6;
            padding: 20px 10px;
        }
        .container {
            width: min(720px, 100%);
            background: linear-gradient(180deg, rgba(124,92,255,0.08), rgba(255,92,154,0.08)), var(--card);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.35);
        }
        .lang-selector {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-bottom: 16px;
        }
        .lang-btn {
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.12);
            background: rgba(255,255,255,0.06);
            color: var(--text);
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s ease;
            font-family: inherit;
        }
        .lang-btn:hover { background: rgba(255,255,255,0.1); transform: translateY(-1px); }
        .lang-btn.active {
            background: linear-gradient(180deg, rgba(124,92,255,0.3), rgba(124,92,255,0.2));
            border-color: var(--accent);
            color: #d9d6ff;
        }
        .header { text-align: center; margin-bottom: 24px; }
        .title { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
        .subtitle { color: var(--muted); font-size: 14px; }
        .loading { text-align: center; padding: 40px; color: var(--muted); }
        .error { text-align: center; padding: 40px; color: var(--wrong); }
        .start-screen { text-align: center; }
        .db-info {
            display: inline-block;
            padding: 8px 14px;
            margin: 16px 0;
            background: rgba(124,92,255,0.1);
            border: 1px solid rgba(124,92,255,0.3);
            border-radius: 8px;
            font-size: 13px;
            color: #c9b3ff;
        }
        .difficulty-selector {
            display: flex;
            gap: 8px;
            margin: 16px 0;
            padding: 12px;
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 10px;
        }
        .difficulty-btn {
            flex: 1;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.12);
            background: rgba(255,255,255,0.06);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .difficulty-btn:hover { background: rgba(255,255,255,0.1); transform: translateY(-1px); }
        .difficulty-btn.active {
            background: linear-gradient(180deg, rgba(124,92,255,0.3), rgba(124,92,255,0.2));
            border-color: var(--accent);
            color: #d9d6ff;
        }
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.14);
            background: linear-gradient(180deg, rgba(124,92,255,0.25), rgba(124,92,255,0.15));
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            font-size: 14px;
            margin-top: 16px;
        }
        .btn:hover { transform: translateY(-1px); filter: brightness(1.05); }
        .question-card { display: none; text-align: center; }
        .category-badge {
            display: inline-block;
            padding: 4px 10px;
            margin-bottom: 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .category-artist { background: rgba(255,92,154,0.2); color: #ffadd2; }
        .category-song { background: rgba(124,92,255,0.2); color: #c9b3ff; }
        .category-general { background: rgba(52,152,219,0.2); color: #85d7ff; }
        .question { font-size: 22px; font-weight: 600; margin: 16px 0; line-height: 1.4; }
        .options { display: grid; gap: 10px; margin: 24px 0; }
        .option {
            padding: 14px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.12);
            background: rgba(255,255,255,0.06);
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            font-size: 16px;
            color: var(--text);
            text-align: left;
        }
        .option:hover:not(.disabled) { background: rgba(255,255,255,0.1); transform: translateY(-1px); }
        .option.disabled { cursor: not-allowed; opacity: 0.7; }
        .option.correct { background: rgba(46, 204, 113, 0.15); border-color: rgba(46, 204, 113, 0.6); }
        .option.wrong { background: rgba(231, 76, 60, 0.15); border-color: rgba(231, 76, 60, 0.6); }
        .feedback { margin-top: 16px; padding: 12px; border-radius: 8px; font-size: 14px; display: none; }
        .feedback.show { display: block; }
        .feedback.correct {
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
            color: #5ce8a8;
        }
        .feedback.wrong {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            color: #ff8c82;
        }
        .progress { margin-top: 16px; font-size: 14px; color: var(--muted); }
        .result { display: none; text-align: center; }
        .result h2 { font-size: 24px; margin-bottom: 16px; }
        .score-breakdown {
            display: inline-block;
            margin: 16px 0;
            padding: 12px 20px;
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
        }
        @media (max-width: 640px) {
            .container { padding: 20px; }
            .title { font-size: 24px; }
            .question { font-size: 18px; }
            .difficulty-selector { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="lang-selector">
            <button class="lang-btn active" data-lang="ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</button>
            <button class="lang-btn" data-lang="ja">üáØüáµ Êó•Êú¨Ë™û</button>
        </div>
        <div class="header">
            <h1 class="title" id="mainTitle">üé§ K-pop Quiz</h1>
            <p class="subtitle" id="subtitle">ÎãπÏã†Ïùò K-pop ÏßÄÏãùÏùÑ ÌÖåÏä§Ìä∏Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
        </div>
        <div class="loading" id="loading">
            <p id="loadingText">üìö Î°úÎî© Ï§ë...</p>
        </div>
        <div class="error" id="error" style="display:none;">
            <p id="errorText">‚ö†Ô∏è Î¨∏Ï†ú Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</p>
        </div>
        <div class="start-screen" id="startScreen" style="display:none;">
            <div class="db-info" id="dbInfo">Î¨∏Ï†ú DB Î°úÎî© Ï§ë...</div>
            <div class="difficulty-selector">
                <button class="difficulty-btn active" data-difficulty="easy" id="easyBtn">
                    üå± <span class="diff-text">Ïâ¨ÏõÄ</span><br><small>10Î¨∏Ï†ú</small>
                </button>
                <button class="difficulty-btn" data-difficulty="medium" id="mediumBtn">
                    ‚≠ê <span class="diff-text">Î≥¥ÌÜµ</span><br><small>15Î¨∏Ï†ú</small>
                </button>
                <button class="difficulty-btn" data-difficulty="hard" id="hardBtn">
                    üî• <span class="diff-text">Ïñ¥Î†§ÏõÄ</span><br><small>20Î¨∏Ï†ú</small>
                </button>
            </div>
            <button class="btn" id="startBtn">ÌÄ¥Ï¶à ÏãúÏûëÌïòÍ∏∞</button>
        </div>
        <div class="question-card" id="questionCard">
            <span class="category-badge" id="categoryBadge"></span>
            <h2 class="question" id="question">Î¨∏Ï†úÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë...</h2>
            <div class="options" id="options"></div>
            <div class="feedback" id="feedback"></div>
            <div class="progress" id="progress">Î¨∏Ï†ú 1 / 10</div>
            <button class="btn" id="nextBtn" style="display:none;">Îã§Ïùå Î¨∏Ï†ú</button>
        </div>
        <div class="result" id="result">
            <h2 id="resultTitle">ÌÄ¥Ï¶à ÏôÑÎ£å!</h2>
            <div class="score-breakdown" id="scoreBreakdown"></div>
            <p id="resultMessage"></p>
            <button class="btn" id="restartBtn">Îã§Ïãú ÏãúÏûë</button>
        </div>
    </div>

    <script>
        // Ïñ∏Ïñ¥Î≥Ñ Î≤àÏó≠
        const translations = {
            ko: {
                mainTitle: "üé§ K-pop Quiz",
                subtitle: "ÎãπÏã†Ïùò K-pop ÏßÄÏãùÏùÑ ÌÖåÏä§Ìä∏Ìï¥Î≥¥ÏÑ∏Ïöî!",
                loading: "üìö Î°úÎî© Ï§ë...",
                error: "‚ö†Ô∏è Î¨∏Ï†ú Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.",
                dbInfo: (total) => `üìö Ï¥ù ${total}Í∞úÏùò Î¨∏Ï†úÍ∞Ä DBÏóê Ï†ÄÏû•ÎêòÏñ¥ ÏûàÏäµÎãàÎã§`,
                easy: "Ïâ¨ÏõÄ",
                medium: "Î≥¥ÌÜµ",
                hard: "Ïñ¥Î†§ÏõÄ",
                startBtn: "ÌÄ¥Ï¶à ÏãúÏûëÌïòÍ∏∞",
                nextBtn: "Îã§Ïùå Î¨∏Ï†ú",
                progress: (cur, total) => `Î¨∏Ï†ú ${cur} / ${total}`,
                resultTitle: "ÌÄ¥Ï¶à ÏôÑÎ£å!",
                restartBtn: "Îã§Ïãú ÏãúÏûë",
                correct: "‚úÖ Ï†ïÎãµ! ",
                wrong: "‚ùå Ïò§Îãµ. ",
                artist: "ÏïÑÌã∞Ïä§Ìä∏",
                song: "ÎÖ∏Îûò",
                general: "ÏùºÎ∞ò"
            },
            ja: {
                mainTitle: "üé§ K-pop „ÇØ„Ç§„Ç∫",
                subtitle: "„ÅÇ„Å™„Åü„ÅÆK-popÁü•Ë≠ò„Çí„ÉÜ„Çπ„Éà„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ!",
                loading: "üìö Ë™≠„ÅøËæº„Åø‰∏≠...",
                error: "‚ö†Ô∏è ÂïèÈ°å„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÅ„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ",
                dbInfo: (total) => `üìö ÂêàË®à${total}Âïè„Åå„Éá„Éº„Çø„Éô„Éº„Çπ„Å´‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Åæ„Åô`,
                easy: "Á∞°Âçò",
                medium: "ÊôÆÈÄö",
                hard: "Èõ£„Åó„ÅÑ",
                startBtn: "„ÇØ„Ç§„Ç∫ÈñãÂßã",
                nextBtn: "Ê¨°„ÅÆÂïèÈ°å",
                progress: (cur, total) => `ÂïèÈ°å ${cur} / ${total}`,
                resultTitle: "„ÇØ„Ç§„Ç∫ÂÆå‰∫Ü!",
                restartBtn: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶",
                correct: "‚úÖ Ê≠£Ëß£! ",
                wrong: "‚ùå ‰∏çÊ≠£Ëß£. ",
                artist: "„Ç¢„Éº„ÉÜ„Ç£„Çπ„Éà",
                song: "Êõ≤",
                general: "‰∏ÄËà¨"
            }
        };

        let currentLang = 'ko';
        let QUESTION_DB = null;
        let gameState = {
            selectedQuestions: [],
            current: 0,
            score: 0,
            difficulty: 'easy'
        };

        const DIFFICULTY_SETTINGS = {
            easy: { questionCount: 10 },
            medium: { questionCount: 15 },
            hard: { questionCount: 20 }
        };

        // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLang = btn.dataset.lang;
                updateLanguage();
                loadQuestionDB();
            });
        });

        function updateLanguage() {
            const t = translations[currentLang];
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('loadingText').textContent = t.loading;
            document.getElementById('errorText').textContent = t.error;
            document.getElementById('startBtn').textContent = t.startBtn;
            document.getElementById('nextBtn').textContent = t.nextBtn;
            document.getElementById('resultTitle').textContent = t.resultTitle;
            document.getElementById('restartBtn').textContent = t.restartBtn;
            
            document.querySelectorAll('.difficulty-btn').forEach((btn) => {
                const diff = btn.dataset.difficulty;
                const textEl = btn.querySelector('.diff-text');
                if (textEl) textEl.textContent = t[diff];
            });
        }

        // DB Î°úÎìú
        async function loadQuestionDB() {
            try {
                // Ï£ºÏù∏ÎãòÏù¥ Î≥¥ÎÇ¥Ï£ºÏã† JSON ÌååÏùº Ïù¥Î¶ÑÏóê ÎßûÏ∂∞ ÏàòÏ†ï
                const fileName = currentLang === 'ja' ? 'quiz_data_jp.json' : 'quiz_data_jp.json'; 
                const response = await fetch(fileName);
                if (!response.ok) throw new Error('Failed to load');
                QUESTION_DB = await response.json();
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('startScreen').style.display = 'block';
                
                const total = getTotalQuestionsInDB();
                document.getElementById('dbInfo').textContent = translations[currentLang].dbInfo(total);
            } catch (err) {
                console.error('Error loading questions:', err);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            }
        }

        function getTotalQuestionsInDB() {
            if (!QUESTION_DB || !QUESTION_DB.categories) return 0;
            return Object.values(QUESTION_DB.categories).reduce((total, category) => total + category.length, 0);
        }

        function shuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function getQuestionsByDifficulty(difficulty) {
            const questions = [];
            for (const [category, categoryQuestions] of Object.entries(QUESTION_DB.categories)) {
                categoryQuestions.forEach(q => {
                    if (q.difficulty === difficulty) {
                        questions.push({ ...q, category });
                    }
                });
            }
            return questions;
        }

        function generateQuizQuestions(difficulty) {
            const availableQuestions = getQuestionsByDifficulty(difficulty);
            const questionCount = DIFFICULTY_SETTINGS[difficulty].questionCount;
            const shuffled = shuffle(availableQuestions);
            return shuffled.slice(0, Math.min(questionCount, shuffled.length));
        }

        // ÎÇúÏù¥ÎèÑ ÏÑ†ÌÉù
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameState.difficulty = btn.dataset.difficulty;
            });
        });

        // Í≤åÏûÑ ÏãúÏûë
        document.getElementById('startBtn').addEventListener('click', () => {
            gameState.selectedQuestions = generateQuizQuestions(gameState.difficulty);
            if (gameState.selectedQuestions.length === 0) {
                alert('Ìï¥Îãπ ÎÇúÏù¥ÎèÑÏùò Î¨∏Ï†úÍ∞Ä ÏóÜÏäµÎãàÎã§!');
                return;
            }
            gameState.current = 0;
            gameState.score = 0;
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('questionCard').style.display = 'block';
            renderQuestion();
        });

        function renderQuestion() {
            const questionData = gameState.selectedQuestions[gameState.current];
            const t = translations[currentLang];
            
            document.getElementById('categoryBadge').textContent = t[questionData.category];
            document.getElementById('categoryBadge').className = `category-badge category-${questionData.category}`;
            document.getElementById('question').textContent = questionData.question;
            document.getElementById('progress').textContent = t.progress(gameState.current + 1, gameState.selectedQuestions.length);
            
            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = '';
            
            questionData.options.forEach((option, idx) => {
                const btn = document.createElement('button');
                btn.className = 'option';
                btn.textContent = option;
                btn.addEventListener('click', () => selectAnswer(idx));
                optionsDiv.appendChild(btn);
            });
            
            document.getElementById('feedback').classList.remove('show', 'correct', 'wrong');
            document.getElementById('nextBtn').style.display = 'none';
        }

        function selectAnswer(choiceIdx) {
            const questionData = gameState.selectedQuestions[gameState.current];
            const isCorrect = choiceIdx === questionData.answer;
            const t = translations[currentLang];
            
            const optionButtons = [...document.getElementById('options').children];
            optionButtons.forEach((btn, idx) => {
                btn.classList.add('disabled');
                if (idx === questionData.answer) {
                    btn.classList.add('correct');
                }
                if (idx === choiceIdx && !isCorrect) {
                    btn.classList.add('wrong');
                }
            });
            
            if (isCorrect) {
                gameState.score++;
            }
            
            const feedbackEl = document.getElementById('feedback');
            feedbackEl.textContent = (isCorrect ? t.correct : t.wrong) + questionData.explanation;
            feedbackEl.classList.add('show', isCorrect ? 'correct' : 'wrong');
            document.getElementById('nextBtn').style.display = 'block';
        }

        document.getElementById('nextBtn').addEventListener('click', () => {
            if (gameState.current < gameState.selectedQuestions.length - 1) {
                gameState.current++;
                renderQuestion();
            } else {
                finishQuiz();
            }
        });

        function finishQuiz() {
            const percentage = Math.round((gameState.score / gameState.selectedQuestions.length) * 100);
            document.getElementById('questionCard').style.display = 'none';
            document.getElementById('result').style.display = 'block';
            document.getElementById('scoreBreakdown').textContent = `${gameState.score} / ${gameState.selectedQuestions.length} (${percentage}%)`;
            
            let message = '';
            if (percentage === 100) {
                message = currentLang === 'ko' ? 'ÏôÑÎ≤ΩÌï¥Ïöî! ÏßÑÏ†ïÌïú K-pop ÎßàÏä§ÌÑ∞ÏûÖÎãàÎã§! üèÜ' : 'ÂÆåÁíß„Åß„ÅôÔºÅÁúü„ÅÆK-pop„Éû„Çπ„Çø„Éº„Åß„Åô„Å≠ÔºÅüèÜ';
            } else if (percentage >= 80) {
                message = currentLang === 'ko' ? 'ÎåÄÎã®Ìï¥Ïöî! Í±∞Ïùò ÎßàÏä§ÌÑ∞Í∏âÏù¥ÏóêÏöî! ‚ú®' : '„Åô„Åî„ÅÑÔºÅ„Åª„Åº„Éû„Çπ„Çø„Éº„É¨„Éô„É´„Åß„ÅôÔºÅ‚ú®';
            } else if (percentage >= 50) {
                message = currentLang === 'ko' ? 'Ï¢ãÏïÑÏöî! Îçî Ïò¨ÎùºÍ∞à Ïàò ÏûàÏñ¥Ïöî! üí™' : '„ÅÑ„ÅÑ„Åß„Åô„Å≠ÔºÅ„ÇÇ„Å£„Å®‰∏äÈÅî„Åß„Åç„Åæ„ÅôÔºÅüí™';
            } else {
                message = currentLang === 'ko' ? 'Í¥úÏ∞ÆÏïÑÏöî‚ÄîÎã§ÏùåÏóê Îçî ÏûòÌï† Ïàò ÏûàÏñ¥Ïöî! üå±' : 'Â§ß‰∏àÂ§´„Åß„Åô‚ÄîÊ¨°„ÅØ„ÇÇ„Å£„Å®ËâØ„Åè„Åß„Åç„Åæ„ÅôÔºÅüå±';
            }
            document.getElementById('resultMessage').textContent = message;
        }

        document.getElementById('restartBtn').addEventListener('click', () => {
            document.getElementById('result').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
        });

        // Ï¥àÍ∏∞ Î°úÎìú
        window.addEventListener('DOMContentLoaded', () => {
            loadQuestionDB();
        });
    </script>
</body>
</html>
